{
	"LinkedTasks": {},
	"LinkedSubProcess": {},
	"Version": "Acc41",
	"Processes": [
		{
			"Name": "Run PowerShell",
			"Modified": "2024-04-03T08:47:22.457",
			"Modifier": "",
			"TagString": null,
			"Tags": [],
			"Description": "",
			"Version": 12,
			"UniqueIdentifier": "8a2840f0-99b5-46a4-a231-d5f346e4a4d6",
			"GraphJson": "",
			"Bpmn": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<bpmn2:definitions xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:bpmn2=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:dc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:di=\"http://www.omg.org/spec/DD/20100524/DI\" id=\"sample-diagram\" targetNamespace=\"http://bpmn.io/schema/bpmn\" xsi:schemaLocation=\"http://www.omg.org/spec/BPMN/20100524/MODEL BPMN20.xsd\"><bpmn2:process id=\"Process_1\" isExecutable=\"false\"><bpmn2:startEvent id=\"StartEvent_1\" name=\"Manual\"><bpmn2:outgoing>Flow_0ifi6fz</bpmn2:outgoing></bpmn2:startEvent><bpmn2:endEvent id=\"Event_0x2jquu\"><bpmn2:incoming>Flow_0ytr4ia</bpmn2:incoming></bpmn2:endEvent><bpmn2:sequenceFlow id=\"Flow_0ifi6fz\" sourceRef=\"StartEvent_1\" targetRef=\"Activity_1vjlvkp\" /><bpmn2:scriptTask id=\"Activity_1vjlvkp\" name=\"Execute Script\"><bpmn2:incoming>Flow_0ifi6fz</bpmn2:incoming><bpmn2:outgoing>Flow_151g6xw</bpmn2:outgoing></bpmn2:scriptTask><bpmn2:sequenceFlow id=\"Flow_151g6xw\" sourceRef=\"Activity_1vjlvkp\" targetRef=\"Activity_029gbr7\" /><bpmn2:scriptTask id=\"Activity_029gbr7\" name=\"Assign result\"><bpmn2:incoming>Flow_151g6xw</bpmn2:incoming><bpmn2:outgoing>Flow_0ytr4ia</bpmn2:outgoing></bpmn2:scriptTask><bpmn2:sequenceFlow id=\"Flow_0ytr4ia\" sourceRef=\"Activity_029gbr7\" targetRef=\"Event_0x2jquu\" /></bpmn2:process><bpmndi:BPMNDiagram id=\"BPMNDiagram_1\"><bpmndi:BPMNPlane id=\"BPMNPlane_1\" bpmnElement=\"Process_1\"><bpmndi:BPMNShape id=\"_BPMNShape_StartEvent_2\" bpmnElement=\"StartEvent_1\"><dc:Bounds x=\"412\" y=\"240\" width=\"36\" height=\"36\" /></bpmndi:BPMNShape><bpmndi:BPMNShape id=\"Activity_1vjlvkp_di\" bpmnElement=\"Activity_1vjlvkp\"><dc:Bounds x=\"600\" y=\"218\" width=\"100\" height=\"80\" /><bpmndi:BPMNLabel /></bpmndi:BPMNShape><bpmndi:BPMNShape id=\"Event_0x2jquu_di\" bpmnElement=\"Event_0x2jquu\"><dc:Bounds x=\"962\" y=\"240\" width=\"36\" height=\"36\" /></bpmndi:BPMNShape><bpmndi:BPMNShape id=\"Activity_029gbr7_di\" bpmnElement=\"Activity_029gbr7\"><dc:Bounds x=\"815\" y=\"243\" width=\"30\" height=\"30\" /><bpmndi:BPMNLabel /></bpmndi:BPMNShape><bpmndi:BPMNEdge id=\"Flow_0ifi6fz_di\" bpmnElement=\"Flow_0ifi6fz\"><di:waypoint x=\"448\" y=\"258\" /><di:waypoint x=\"600\" y=\"258\" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id=\"Flow_151g6xw_di\" bpmnElement=\"Flow_151g6xw\"><di:waypoint x=\"700\" y=\"258\" /><di:waypoint x=\"815\" y=\"258\" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id=\"Flow_0ytr4ia_di\" bpmnElement=\"Flow_0ytr4ia\"><di:waypoint x=\"845\" y=\"258\" /><di:waypoint x=\"962\" y=\"258\" /></bpmndi:BPMNEdge></bpmndi:BPMNPlane></bpmndi:BPMNDiagram></bpmn2:definitions>",
			"ElementParameters": "[{\"Id\":\"StartEvent_1\",\"Type\":0,\"Parameters\":{\"manualTriggerDefaultValue-1\":\"false\",\"manualTriggerDefaultValue-2\":\"true\"},\"SelectedTypeId\":\"ManualTrigger\",\"PromoteResultAs\":null,\"Name\":\"Manual\",\"Description\":null,\"IsDefault\":null,\"ShouldRetry\":null,\"MaxRetryCount\":null,\"ShouldNotLogResult\":null,\"ShouldDispose\":null},{\"Id\":\"Event_0x2jquu\",\"Type\":5,\"Parameters\":{\"expression\":{\"mode\":\"csharp\",\"value\":\"#var.result\"}},\"SelectedTypeId\":null,\"PromoteResultAs\":null,\"Name\":null,\"Description\":null,\"IsDefault\":null,\"ShouldRetry\":null,\"MaxRetryCount\":null,\"ShouldNotLogResult\":null,\"ShouldDispose\":null},{\"Id\":\"Activity_1vjlvkp\",\"Type\":12,\"Parameters\":{\"useStatementMode\":{\"mode\":\"toggle\",\"value\":true},\"variableExpression\":{\"mode\":\"csharp\",\"value\":\"{\\n    var throwIfScriptFails = bool.Parse(#trigger.data.ThrowIfScriptFails);\\n    var output = new System.Text.StringBuilder();\\n    var psPath = Environment.ExpandEnvironmentVariables(@\\\"%SystemRoot%\\\\system32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe\\\");\\n    var inputScript = #trigger.data.Script;\\n    var scriptFailed = false;\\n\\n    var command = $@\\\"\\n$ErrorActionPreference = 'Stop'    \\n$script = @'\\n{inputScript}\\n'@\\n[Console]::OutputEncoding = [System.Text.Encoding]::UTF8\\n$scriptBlock = [ScriptBlock]::Create($script)\\ntry {{$res = & $scriptBlock}} catch {{Write-Host $_.ToString(); exit 1}}\\n$res | ConvertTo-Json -Compress -Depth 10 -ErrorAction SilentlyContinue\\n\\\";\\n\\n    var encodedComand = Convert.ToBase64String(System.Text.Encoding.Unicode.GetBytes(command));\\n    using (var process = new System.Diagnostics.Process())\\n    {\\n        process.StartInfo.FileName = psPath;\\n        process.StartInfo.Arguments = $\\\"-NoProfile -ExecutionPolicy Bypass -EncodedCommand {encodedComand}\\\";\\n        process.StartInfo.UseShellExecute = false;\\n        process.StartInfo.RedirectStandardOutput = true;\\n        process.StartInfo.CreateNoWindow = true;\\n        process.StartInfo.StandardOutputEncoding = System.Text.Encoding.UTF8;\\n        process.Start();\\n        process.BeginOutputReadLine();\\n        process.OutputDataReceived += (sender, e) =>\\n        {\\n            if (!string.IsNullOrEmpty(e.Data))\\n            {\\n                output.AppendLine(e.Data);\\n            }\\n        };\\n        process.WaitForExit();\\n        scriptFailed = process.ExitCode != 0;\\n    }\\n\\n    if (scriptFailed && throwIfScriptFails)\\n    {\\n        throw new Exception(output.ToString());\\n    }\\n    return output.ToString();\\n}\"},\"shouldAssignVariable\":{\"mode\":\"toggle\",\"value\":true},\"variableName\":\"output\"},\"SelectedTypeId\":null,\"PromoteResultAs\":null,\"Name\":\"Execute Script\",\"Description\":null,\"IsDefault\":null,\"ShouldRetry\":null,\"MaxRetryCount\":null,\"ShouldNotLogResult\":null,\"ShouldDispose\":null},{\"Id\":\"Activity_029gbr7\",\"Type\":12,\"Parameters\":{\"variableName\":\"result\",\"variableExpression\":{\"mode\":\"csharp\",\"value\":\"bool.Parse(#trigger.data.SuppressOutput) ? null : new JObject(new JProperty(\\\"Result\\\", JToken.Parse(#var.output)))\"},\"shouldAssignVariable\":{\"mode\":\"toggle\",\"value\":true}},\"SelectedTypeId\":null,\"PromoteResultAs\":null,\"Name\":\"Assign result\",\"Description\":null,\"IsDefault\":null,\"ShouldRetry\":null,\"MaxRetryCount\":null,\"ShouldNotLogResult\":null,\"ShouldDispose\":null}]",
			"ManualTriggerJson": "[{\"type\":\"System.String\",\"inputType\":\"text\",\"parameterType\":\"TextParameter\",\"defaultValue\":\"\",\"displayOption\":\"\",\"conditionalDisplayProperty\":\"\",\"conditionalDisplayValues\":[],\"isInvalid\":false,\"invalidString\":\"\",\"name\":\"Script\",\"isSecret\":false},{\"type\":\"System.String\",\"inputType\":\"text\",\"parameterType\":\"TextParameter\",\"defaultValue\":\"\\\"false\\\"\",\"displayOption\":\"\",\"conditionalDisplayProperty\":\"\",\"conditionalDisplayValues\":[],\"isInvalid\":false,\"invalidString\":\"\",\"name\":\"SuppressOutput\",\"isSecret\":false,\"nonStringifiedDefaultValue\":\"false\"},{\"type\":\"System.String\",\"inputType\":\"text\",\"parameterType\":\"TextParameter\",\"defaultValue\":\"\\\"true\\\"\",\"displayOption\":\"\",\"conditionalDisplayProperty\":\"\",\"conditionalDisplayValues\":[],\"isInvalid\":false,\"invalidString\":\"\",\"name\":\"ThrowIfScriptFails\",\"isSecret\":false,\"nonStringifiedDefaultValue\":\"true\"}]",
			"IsSubprocess": true,
			"TriggersJson": "[{\"$type\":\"ManualTrigger\",\"config\":{\"manualTriggerDefaultValue-1\":\"false\",\"manualTriggerDefaultValue-2\":\"true\"},\"name\":\"Manual\",\"id\":\"StartEvent_1\",\"shouldNotLogParameters\":null}]",
			"AssemblyName": "Frends.ExecutableProcess.frends_RunPowerSh",
			"PackageId": "RunPowerSh8a2840f099b546a4a231d5f346e4a4d6",
			"PackageVersion": "0.1.12.0",
			"UsedTasksJson": "[]",
			"UsedSubprocessesJson": "{}",
			"ProcessExecutionVersion": "4.3.5",
			"FrendsVersion": "5.6.3.1912",
			"TargetFramework": "netstandard20",
			"StaticRequiredEnvironmentVariables": [],
			"RequiredEnvironmentVariables": [],
			"PromotedResultVariablesJson": "[]",
			"MajorVersion": 0,
			"MinorVersion": 1,
			"IsForMonitoringRule": false,
			"ProcessVariablesJson": null
		}
	]
}